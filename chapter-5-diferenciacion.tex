
\chapter{Diferenciación}

Con este capítulo entramos de lleno en el terreno del Cálculo diferencial e integral.
Todo lo que hemos visto hasta ahora puede considerarse una preparación, larga y trabajosa, pero necesaria, para los temas que vamos a tratar a partir de este capítulo.

\section{Definición de derivada}

Consideremos una función $f$ definida en un intervalo abierto $(a,b)$ y sean $x_0$, $x_0+h$ puntos pertenecientes a $(a,b)$. 
La variación \emph{absoluta} de $f$ cuando $x$ se incrementa de $x_0$ a $x_0+h$ está medida por $f(x_0+h)-f(x_0)$, pero si queremos medir la variación \emph{relativa} de $f$, entonces debemos dividir esa diferencia por lo que se incrementó la variable $x$, es decir, por $h$:
\[
\text{Variación relativa de $f$ para $x$ de $x_0$ a $x_0+h$:}
\quad\frac{f(x_0+h)-f(x_0)}h.
\]
Este cociente recibe el nombre de \emph{cociente incremental}.

Ese cociente depende de $h$, pero si tomamos $h$ cada vez más pequeño, entonces tendremos una \emph{variación instantánea} de $f$ en $x_0$. Más precisamente:

\begin{definition}
Sea $f$ una función definida en un intervalo abierto $(a,b)$ y sea $x_0\in(a,b)$. Decimos que \emph{$f$ es derivable en $x_0$} si existe el límite:
\[
\lim_{h\to 0} \frac{f(x_0+h)-f(x_0)}{h}.
\]
Si este límite existe, se indica $f'(x_0)$ y se llama \emph{derivada de $f$ en $x_0$}.
\end{definition}

Es decir, \emph{la derivada de $f$ en $x_0$} es 
\[
f'(x_0) = \lim_{h\to 0} \frac{f(x_0+h)-f(x_0)}{h},
\]
siempre que el límite exista.

\begin{example}
    Consideremos la función $f(x)=x^2$. Veamos si es derivable en $x_0=2$, es decir, veamos si existe $f'(2)$:
    \begin{align*}
    f'(2) 
    &= \lim_{h\to 0}\frac{f(2+h)-f(2)}{h}
    = \lim_{h\to 0}\frac{(2+h)^2-(2)^2}{h}
    = \lim_{h\to 0}\frac{4+4h+h^2-4}{h}
    \\
    &= \lim_{h\to 0}\frac{4h+h^2}{h}
    = \lim_{h\to 0}\frac{4h}h+\frac{h^2}{h}
    = \lim_{h\to 0}4+h
    = 4+0=4.
    \end{align*}
\end{example}

La derivada de una función en un punto tiene una sencilla interpretación geométrica, en términos de la representación gráfica de dicha función. Para establecerla, consideramos la recta que pasa por los puntos de coordenadas $(x_0,y_0)=(x_0,f(x_0))$ y $(x_1,y_1)=(x_0+h,f(x_0+h))$. La pendiente de esa recta es
\[
m(h) = \frac{y_1-y_0}{x_1-x_0}
= \frac{f(x_0+h)-f(x_0)}{x_0+h-x_0}
= \frac{f(x_0+h)-f(x_0)}{h}.
\]

\centerline{\includegraphics[width=.8\textwidth]{pics/tangente.png}}

Si ahora tomamos límite cuando $h\to 0$, vemos que la recta considerada se va aproximando a la recta $L$ tangente a la curva en el punto de coordenadas $(x_0,f(x_0))$. Por otro lado, $\lim_{h\to 0}m(h)=f'(x_0)$. Deducimos entonces lo siguiente:
\begin{quote}
    Si $f$ es una función definida en $(a,b)$ y existe $f'(x_0)$ para un $x_0\in(a,b)$, entonces $f'(x_0)$ es igual a la pendiente de la recta tangente a la gráfica de $f$ en el punto $(x_0,f(x_0))$.
\end{quote}

La ecuación de la recta tangente $L$ es ahora fácil de encontrar. Tiene pendiente $f'(x_0)$ y pasa por $(x_0,y_0)=(x_0,f(x_0))$:
\[
\frac{y-y_0}{x-x_0} = f'(x_0)
\quad\implies\quad
y - y_0 = f'(x_0)\, (x-x_0).
\]

\begin{example}
    Calculemos la ecuación de la recta tangente a la gráfica de $y=x^2$ en el punto $(x_0,y_0)=(x_0,x_0^2)$, para un $x_0\in\R$ genérico.

    Comenzamos calculando la pendiente de dicha recta, que es la derivada de $f(x)=x^2$ en $x=x_0$. Repetimos lo que hicimos en el ejemplo anterior, cambiando $2$ por $x_0$:
        \begin{align*}
    f'(x_0) 
    &= \lim_{h\to 0}\frac{f(x_0+h)-f(x_0)}{h}
    = \lim_{h\to 0}\frac{(x_0+h)^2-(x_0)^2}{h}
    = \lim_{h\to 0}\frac{x_0^2+2\, x_0\, h+h^2-x_0^2}{h}
    \\
    &= \lim_{h\to 0}\frac{2\, x_0 \, h+h^2}{h}
    = \lim_{h\to 0}\frac{2\, x_0\, \cancel{h}}{\cancel{h}}+\frac{h^{\cancel{2}}}{\cancel{h}}
    = 2\,x_0+0=2\,x_0.
    \end{align*}
    Es decir, la pendiente de la recta tangente a la gráfica de $y=x^2$ en el punto $(x_0,y_0)=(x_0,x_0^2)$ es $2 x_0$. 
    Por lo tanto, la recta tangente es la que tiene esa pendiente y  pasa por $(x_0,y_0)=(x_0,x_0^2)$:
    \[
    \frac{y-y_0}{x-x_0} = 2\, x_0
    \quad\implies\quad
    y - y_0 = 2 \, x_0\, (x-x_0)
    \quad\implies\quad
    y = x_0^2+2 \, x_0\, (x-x_0).
    \]
\end{example}

En el ejemplo anterior vimos que $f(x)=x^2$ tiene derivada en cualquier punto $x_0\in\R$ y que $f'(x_0)=2x_0$ o lo que es lo mismo, $f'(x)=2x$, para todo \xiR.



Esto no es así para todas las funciones, por ejemplo, la función \emph{valor absoluto} no es derivable en $x_0=0$.

\begin{example}
    Consideremos $f(x)=|x|$ y veamos si es derivable en $x_0=0$.
    \begin{align*}
        \lim_{h\to 0} \frac{|0+h|-|0|}h
        =
        \lim_{h\to 0} \frac{|h|}h.
    \end{align*}
    Pero 
    \[
        \lim_{h\to 0^+} \frac{|h|}h
        = \lim_{h\to 0^+} \frac{h}h = 1
        \qquad\text{y}\qquad
        \lim_{h\to 0^-} \frac{|h|}h
        = \lim_{h\to 0^-} \frac{-h}h = -1.
    \]
    Por lo tanto no existe $\lim_{h\to 0} \frac{|0+h|-|0|}h$ y $f(x)=|x|$ no es derivable en $x_0=0$.

    ?`Cuál es la recta tangente al gráfico de $y=|x|$ en el origen $(0,0)$? ?`Existe?

    Aunque sí es derivable en $x_0$ si $x_0\neq 0$.
    Queda como ejercicio verificar que
    \[
    f'(x_0) = \begin{cases}
        1,\quad&\text{si $x_0>0$},\\
        -1,\quad&\text{si $x_0<0$}.
        \end{cases}
    \]
\end{example}

La derivada tiene también una interpretación física que es importante destacar. Para establecerla, consideraremos un cuerpo desplazándose sobre una línea recta, por ejemplo, un automóvil en un tramo recto de una ruta.

Fijando una unidad de medida para las longitudes (por ejemplo, el kilómetro) y una unidad de medida para el tiempo (por ejemplo, la hora), entonces la velocidad de dicho automóvil estará medida (en kilómetros por hora) por el cociente entre el espacio que haya recorrido y el tiempo que haya empleado en recorrerlo.

Eso, desde luego, mide una velocidad promedio, pues, en el intervalo de tiempo considerado, el móvil puede haber recorrido algunas partes del trayecto más rápido que otras o, incluso, haberse detenido un rato.
Pero hay una noción de velocidad que no es un promedio, que es una noción de \emph{velocidad instantánea}, y es la que marca el velocímetro.

Independientemente de cual sea el mecanismo por el cual el velocímetro marca la velocidad en cada instante, hay una manera de llegar (teóricamente) a medir velocidades instantáneas a partir de velocidades promedio: si podemos establecer qué posición ocupa el móvil en cada instante, entonces tenemos la distancia recorrida, digamos $s$, en función del tiempo, $s=s(t)$.

Para calcular la velocidad en el instante $t_0$, comenzamos considerando un tiempo $t$ a partir de $t_0$ y calculamos la velocidad promedio entre $t_0$ y $t_0+t$:
\[
\frac{\text{distancia}}{\text{tiempo}}
=\frac{s(t_0+t)-s(t_0)}{t_0+t-t_0}
=\frac{s(t_0+t)-s(t_0)}{t}.
\]
Ahora, para calcular la velocidad en el instante $t_0$, tomamos límite en esta expresión cuando $t\to 0$. Lo que obtenemos es
\[
s'(t_0) = \lim_{t\to t_0}\frac{s(t_0+t)-s(t_0)}{t}.
\]
Deducimos entonces:
\begin{quote}
    Si, en un movimiento rectilíneo, tenemos el espacio recorrido en función del tiempo $s=s(t)$, entonces la velocidad del móvil en el instante $t_0$ está dada por la derivada de dicha función en $t_0$, es decir $s'(t_0)$.
\end{quote}

Las interpretaciones geométricas y física de la derivada tienen una notable importancia en las respectivas disciplinas, pero en este apunte sólo discutiremos (más adelante) unas pocas consecuencias geométricas, dejando el resto para los correspondientes cursos de geometría y física.

Antes de pasar a estudiar propiedades de las funciones derivables, notemos que 
\[
\lim_{h\to 0} \frac{f(x_0+h)-f(x_0)}{h}
= 
\lim_{x\to x_0} \frac{f(x)-f(x_0)}{x-x_0},
\]
que se deduce usando el cambio de variables $x=x_0+h$.

\subsection*{Definición alternativa (pero equivalente) de derivada}

Observemos que, por propiedades de límites tenemos las siguientes equivalencias:
\begin{align*}
f'(x_0) = \lim_{h\to 0} \frac{f(x_0+h)-f(x_0)}{h}
&\quad\iff\quad
f'(x_0) - \lim_{h\to 0} \frac{f(x_0+h)-f(x_0)}{h} = 0
\\
&\quad\iff\quad
\lim_{h\to 0} \bigg[f'(x_0) - \frac{f(x_0+h)-f(x_0)}{h} \bigg]= 0
\\
&\quad\iff\quad
\lim_{h\to 0} \frac{f'(x_0)\cdot h - \big(f(x_0+h)-f(x_0)\big)}{h}= 0
\\
&\quad\iff\quad
\lim_{h\to 0} \frac{f(x_0+h) - f(x_0) - f'(x_0)\cdot h}{h}= 0
\\
&\quad\iff\quad
f(x_0+h) - f(x_0) - f'(x_0)\cdot h= o(h).
\end{align*}
Es decir, $f'(x_0)$ es el número real que cumple que
\[
f(x_0+h) = f(x_0) + f'(x_0) \, h + o(h).
\]
Más precisamente
\begin{quote}
    $f$ es derivable en $x_0$ si existe un número que denotamos $f'(x_0)$ para el que se cumple que 
    \begin{equation}\label{eq:derivada-o(h)}
    f(x_0+h) = f(x_0) + f'(x_0) \, h + o(h).
    \end{equation}
\end{quote}

\begin{example}
    Veamos cómo se calcula la derivada de $f(x)=x^2$ con este método, en un $x_0\in\R$:
    \begin{align*}
        f(x_0+h) &= (x_0+h)^2 
        = \underbrace{x_0^2}_{f(x_0)} + \underbrace{2 \, x_0 }_{\text{número}} \, h + \underbrace{h^2}_{o(h)}
        = f(x_0) + \underbrace{2 \, x_0}_{f'(x_0)} \, h + o(h).
    \end{align*}
    Luego $f'(x_0)=2\, x_0$.
\end{example}

\begin{example}
    Veamos cómo se calcula la derivada de $f(x)=x^3$ con este método, en un $x_0\in\R$.
    \begin{align*}
        f(x_0+h) &= (x_0+h)^3 
        = \underbrace{x_0^3}_{f(x_0)} + \underbrace{3 \, x_0^2 }_{\text{número}} \, h + \underbrace{3 \, x_0 \, h^2+ h^3}_{o(h)}
        = f(x_0) + \underbrace{3 \, x_0^2}_{f'(x_0)} \, h + o(h).
    \end{align*}
    Luego $f'(x_0)=3\, x_0^2$.
\end{example}

\paragraph{Derivabilidad vs. Continuidad.}

La noción de derivada es \emph{puntual}, hemos definido qué quiere decir que una función es derivable \emph{en un punto $x_0$}.

Tenemos ya otra noción puntual, que es la de \emph{continuidad}. ?`Cómo se relacionan estos conceptos?

\begin{proposition}
    Si una función es derivable en $x_0$, entonces es continua en $x_0$.
\end{proposition}

\begin{proof}
    Si $f$ es derivable en $x_0$, entonces existe un número $f'(x_0)$ que cumple
    \[
    f(x_0+h) = f(x_0) + f'(x_0) \, h + o(h).
    \]
    Tomando límite cuando $h\to0$ a ambos lados tenemos que
    \begin{align*}
    \lim_{h\to 0} f(x_0+h) 
    &= \lim_{h\to 0}\big(f(x_0) + f'(x_0) \, h + o(h)\big)
    \\
    &= \lim_{h\to 0}f(x_0) \,+\, \lim_{h\to 0}f'(x_0) \, h \,+\, \lim_{h\to 0}o(h)
    \\
    &= f(x_0)+0+0=f(x_0).
    \end{align*}
    Luego, $\lim_{h\to 0}f(x_0+h)=f(x_0)$, o lo que es lo mismo,
    $\D \lim_{x\to x_0}f(x)=f(x_0)$.
\end{proof}

La recíproca de esta proposición no es cierta. Basta con pensar en la función \emph{valor absoluto}, que es continua en $x_0=0$, pero no es derivable en ese punto.

\begin{example}
    Otro ejemplo interesante es el dado por la siguiente función:
    \[
    f(x) = \begin{cases} x \sen \frac1x,\quad&\text{si $x\neq 0$},
    \\
    0, \quad&\text{si $x=0$}.
    \end{cases}
    \]
    Ya vimos en el capítulo anterior que esta función es continua en $x_0=0$ (por el teorema del emparedado).
    Veamos qué ocurre si queremos calcular $f'(0)$:
    \begin{align*}
        f'(0) 
        &= \lim_{x\to 0} \frac{f(x)-f(0)}{x-0}
        = \lim_{x\to 0} \frac{x\,\sen\frac1x - 0}{x}
        \\
        &= \lim_{x\to 0} \frac{x\,\sen\frac1x}{x}
        = \lim_{x\to 0} \sen\frac1x.
    \end{align*}
    También vimos en el capítulo anterior que este límite no existe.
    Luego, no existe $f'(0)$.
\end{example}
\subsubsection*{Ejercicios de la sección~\getcurrentref{chapter}.\getcurrentref{section}}

\begin{enumerate}
\input{ejercicios-ch-5-s-1}
\end{enumerate}


\section{La función derivada. Reglas de derivación}

Supongamos que $f$ está definida en un intervalo abierto $(a,b)$ y que es derivable en todos los puntos de $(a,b)$.
Cuando esto ocurre, diremos que \emph{$f$ es derivable en $(a,b)$}.
Para cada $x\in(a,b)$ tenemos una derivada $f'(x)$. De esta manera, tenemos definida una función:
\[
x \to f'(x),
\]
que se llamará \emph{función derivada de $f$} y se indica $f'$.

%\subsection{Reglas de derivación}

Para seguir adelante con el cálculo de derivadas. Necesitamos tres propiedades que nos indican cómo se comporta la derivada frente a las operaciones elementales de funciones: la suma el producto y el cociente.

\begin{proposition}
    Si $f$ es derivable en $x_0$ y $c$ es una constante, entonces $c\, f$ es derivable en $x_0$ y además
    \[
    (c\, f)'(x_0) = c \, f'(x_0).
    \]
    En palabras: \emph{la derivada de una constante por una función es la constante por la derivada de la función}.
\end{proposition}

\begin{proof}
Utilizaremos la definición alternativa dada en~\eqref{eq:derivada-o(h)}.
Llamamos $g(x)=c\, f(x)$ y por la propiedad distributiva, obtenemos
\begin{align*}
    g(x_0+h) &= (c \, f)(x_0+h) = c \, f(x_0+h) 
    \\
    &= c\, \big( f(x_0) + f'(x_0)\cdot h + o(h) \big) 
    \\
    &=  c\, f(x_0) + c\, f'(x_0)\cdot h + c\, o(h)
    \\
    &=  g(x_0) + c\, f'(x_0)\cdot h +  o(h).
\end{align*}    
Por lo tanto $g'(x_0) = c\, f'(x_0)$.
\end{proof}

\begin{example}
    Ya sabemos que la derivada de $x^2$ es $2\, x$, por lo tanto, 
    \[
    \text{la derivada de $5 x^2$ es  $5 \cdot 2 \, x = 10\,  x$.}
    \]
\end{example}

\begin{proposition}
    Si $f$ y $g$ son derivables en $x_0$, entonces $f+g$ es derivable en $x_0$ y además
    \[
    (f+g)'(x_0) = f'(x_0)+g'(x_0).
    \]
    En palabras: \emph{la derivada de la suma es la suma de las derivadas}.
\end{proposition}

\begin{proof}
Utilizaremos la definición alternativa dada en~\eqref{eq:derivada-o(h)}.
\begin{align*}
    (f+g)(x_0+h) 
    &= f(x_0+h)+g(x_0+h)
    \\
    &= \big[f(x_0)+f'(x_0)\, h + o(h)\big]
    + \big[g(x_0)+g'(x_0)\, h + o(h)\big]
    \\
    &= \big[f(x_0)+g(x_0)\big] +
    \big[f'(x_0)\, h + g'(x_0)\, h\big] 
    + \big[o(h)+ o(h)\big]
    \\
    &= (f+g)(x_0) +
    \big[f'(x_0)+ g'(x_0)\big] \, h
    + o(h).
\end{align*}
Por lo tanto $(f+g)'(x_0) = f'(x_0)+g'(x_0)$.
\end{proof}

\begin{example}
    Ya sabemos que la derivada de $5 \,x^2$ es $10\,x$, y que la de $x^3 = 3\, x^2$.
    Por lo tanto, 
    \[
    \text{la derivada de $5 x^2 + 6 x^3$ es $10 \, x + 6 \cdot 3 \, x^2 = 10 x + 18 x^2$.}
    \]
\end{example}

\begin{proposition}
    Si $f$ y $g$ son derivables en $x_0$, entonces $f\cdot g$ es derivable en $x_0$ y además
    \[
    (f\cdot g)'(x_0) = f'(x_0)\cdot g(x_0)+f(x_0)\cdot g'(x_0).
    \]
\end{proposition}

\begin{proof}
Utilizaremos la definición alternativa dada en~\eqref{eq:derivada-o(h)}.
Por la propiedad distributiva,
\begin{align*}
    (f\cdot g)(x_0+h) 
    ={}& f(x_0+h)\cdot g(x_0+h)
    \\
    ={}& \big[f(x_0)+f'(x_0)\, h + o(h)\big]
    \cdot \big[g(x_0)+g'(x_0)\, h + o(h)\big]
    \\
    ={}& f(x_0)\cdot g(x_0) 
    + f'(x_0)\cdot g(x_0) 
    + \underbrace{o(h) \cdot g(x_0) }_{o(h)}
    \\
    &+ f(x_0) \cdot g'(x_0) \, h
    + \underbrace{f'(x_0) \, h \cdot g'(x_0) \, h}_{o(h)}
    + \underbrace{o(h) \cdot g'(x_0) \, h}_{o(h)}
    \\
    &
    + \underbrace{f(x_0) \cdot o(h)}_{o(h)}
    + \underbrace{f'(x_0) \cdot o(h)}_{o(h)}
    + \underbrace{o(h) \cdot o(h)}_{o(h)}
    \\
    ={}& f(x_0)\cdot g(x_0) 
    + \big[ f'(x_0)\cdot g(x_0)+f(x_0)\cdot g'(x_0) \big] \, h 
    + o(h).
\end{align*}
Por lo tanto $(f\cdot g)'(x_0) = f'(x_0)\cdot g(x_0)+f(x_0)\cdot g'(x_0)$.
\end{proof}

\begin{proposition}
    Si $g$ es derivable en $x_0$, y $g(x_0)\neq 0$, entonces $1/g$ es derivable en $x_0$ y además
    \[
    \Big(\frac1g\Big)'(x_0) = - \frac{g'(x_0)}{g(x_0)^2}.
    \]
\end{proposition}

\begin{proof}
    Analicemos el cociente incremental:
    \begin{align*}
         % \frac{\frac1g(x_0+h)-\frac1g(x_0)}h
        \frac{\frac1{g(x_0+h)}-\frac1{g(x_0)}}h
        &= \frac1h \, \left[\frac1{g(x_0+h)}-\frac1{g(x_0)}\right]
        = \frac1h \, \frac{g(x_0)-g(x_0+h)}{g(x_0+h)\,g(x_0)}
        \\
        &= \frac1{g(x_0+h)\,g(x_0)} \, \frac{g(x_0)-g(x_0+h)}h
        \\
        &= - \frac1{g(x_0+h)\,g(x_0)} \, \frac{g(x_0+h)-g(x_0)}h.
    \end{align*}
    Recordamos ahora que como $g$ es derivable en $x_0$ es también continua, y por hipótesis, $g(x_0)\neq 0$. 
    Luego, 
    \[
    \limho \frac1{g(x_0+h)\,g(x_0)} = \frac1{g(x_0)\,g(x_0)} = \frac1{g(x_0)^2}. 
    \]
    Además, $\limho \frac{g(x_0+h)-g(x_0)}h = g'(x_0)$.
    Finalmente,
    \[
    \left(\frac1g\right)'(x_0) = \limho \frac{\frac1{g(x_0+h)}-\frac1{g(x_0)}}h = - \frac{g'(x_0)}{g(x_0)^2}.
    \qedhere
    \]
\end{proof}

Combinando este último resultado con la regla para el producto, obtenemos la regla de derivación para el cociente:

\begin{corollary}
    Si $f$ y $g$ son derivables en $x_0$, y $g(x_0)\neq 0$, entonces $f/ g$ es derivable en $x_0$ y además
    \[
    \left(\frac f g\right)'(x_0) = \frac{f'(x_0)\cdot g(x_0)-f(x_0)\cdot g'(x_0)}{g(x_0)^2}.
    \]
\end{corollary}

\begin{proof}
Como $\D\frac fg = f \cdot \frac1g$ tenemos que
    \begin{align*}
        \left(\frac f g\right)'(x_0) 
        &= \left(f \cdot \frac 1 g\right)'(x_0)
        = f'(x_0) \left(\frac 1 g\right)(x_0) + f(x_0) \left(\frac 1 g\right)'(x_0).
    \end{align*}
Como $g$ es derivable en $x_0$ y $g(x_0)\neq 0$, tenemos que $\left(\frac1g\right)'(x_0) = - \frac{g'(x_0)}{g(x_0)^2}$ y entonces
    \begin{align*}
        \left(\frac f g\right)'(x_0) 
        &= f'(x_0) \frac 1 {g(x_0)} + f(x_0) \left(- \frac{g'(x_0)}{g(x_0)^2}\right)
        = \frac{f'(x_0)\cdot g(x_0)-f(x_0)\cdot g'(x_0)}{g(x_0)^2}.
        \qedhere
    \end{align*}
\end{proof}

Podemos resumir los últimos resultados de la siguiente manera:
\[
(c\, f)' = c\, f',
\qquad
(f+g)' = f'+g',
\qquad
(f\cdot g)' = f'g+f g',
\qquad
\left(\frac f g\right)' = \frac{f'g-f g'}{g^2},
\]
donde la última fórmula tiene sentido en los puntos $x$ donde $g(x)\neq 0$.
Es importante observar que si bien la derivada de la suma es la suma de las derivadas, no es cierto que la derivada del producto es el producto de las derivadas, ni que la derivada del cociente es el cociente de las derivadas.

\paragraph{Notación de Leibniz.}
Otra manera muy usual de denotar a las derivadas es la siguiente, conocida como notación de Leibniz:
\[
f'(x)= \frac{df(x)}{dx}, \qquad\text{o también}\quad f'= \frac{df}{dx}.
\]
Si estamos pensando que $y=f(x)$, es decir, $y$ es la variable \emph{dependiente}, definida como $f(x)$, entonces también suele escribirse
\[
f'(x) = \frac{dy}{dx}.
\]
Esta forma es muy útil cuando uno quiere representar la derivada de una función \emph{anónima}, es decir una función que no tiene nombre asignado. Por ejemplo:
\[
\frac{d (x^2)}{dx} = 2x,
\qquad
\frac{d (5 \, x^2)}{dx} = 5 \frac{d (x^2)}{dx} =5\cdot 2x = 10x.
\]

Con la notación de Leibniz, las reglas de derivación recién presentadas pueden escribirse de la siguiente forma:
\[
\frac{d(c\, f)}{dx} = c\, \frac{df}{dx},
\quad
\frac{d(f+g) }{dx} = \frac{d f}{dx}+\frac{d g}{dx},
\quad
\frac{d(f\cdot g)}{dx} = \frac{df}{dx}g+f \frac{dg}{dx},
\quad
\frac{d\big(\frac f g\big)}{dx} = \frac{\frac{df}{dx}g-f \frac{dg}{dx}}{g^2}.
\]

Finalizamos esta sección aprovechando la regla del producto para saber cuál es la derivada de $f(x) = x^n$ para $n\in\N$.
El caso $n=1$ nos da $f(x)=x$ y $f'(x)=1$, es decir $\frac{dx}{dx}=1$. El caso $n=2$ nos da $\frac{d(x^2)}{dx}=2x$, el caso $n=3$ nos da $\frac{d(x^3)}{dx}=3x^2$. En el caso general, para $n\in\N$, la derivada de $x^n$ será $$\frac{d(x^n)}{dx}=n x^{n-1}$$ y lo vamos a probar por inducción. Ya hemos probado el caso $n=1$ (y también los casos $n=2$ y $n=3$). Supongamos que esta fórmula es válida para un cierto natural $n$ y veamos si es cierta para $n+1$. Observamos que $x^{n+1} = x^n \cdot x$, y utilizando la regla del producto:
\[
\frac{d(x^{n+1})}{dx}
=
\frac{d(x^n\cdot x)}{dx}
= 
\frac{d(x^n)}{dx} x + x^n \frac{dx}{dx}.
\]
Por la hipótesis inductiva, $\frac{d(x^n)}{dx}=n\, x^{n-1}$, así que
\[
\frac{d(x^{n+1})}{dx}
= n\, x^{n-1} \, x + x^n \cdot 1
= n x^n + x^n = (n+1)x^n.
\]

Por lo tanto, todas las funciones polinomiales son derivables, y más aún, 
\begin{multline*}
\text{Si }p(x) = a_n \, x^n + a_{n-1} \, x^{n-1} + \dots + a_2 \, x^2 + a_1 \, x + a_0
\\
\quad\text{\ \ entonces \ \ }
p'(x) = n\, a_n \, x^{n-1} + (n-1) \, a_{n-1} \, x^{n-2} + \dots + 2\, a_2 \, x + a_1.
\end{multline*}

Y por la regla del cociente, también todas las funciones racionales son derivables en todo punto de su dominio (todos los puntos donde el denominador no se anula).





\subsubsection*{Ejercicios de la sección~\getcurrentref{chapter}.\getcurrentref{section}}

\begin{enumerate}
\input{ejercicios-ch-5-s-2}
\end{enumerate}


\section{Ejemplos importantes}

La potencia del Cálculo Diferencial en sus diversas aplicaciones depende del hecho siguiente: es muy fácil probar que casi todas las funciones hasta aquí estudiadas (polinómicas, trigonométricas, logarítmicas, etc.) son derivables en todo su dominio, y es muy fácil encontrar sus funciones derivadas. Veamos cómo.

\begin{example}
    Consideremos la función constante $f(x)=c$, para todo \xiR. Su derivada es la función nula. En efecto, para \xiR,
    \[
    \frac{f(x+h)-f(x)}{h} = \frac{c-c}h = \frac0h = 0,\ \ \forall h\neq 0
    \quad\implies\quad
    \lim_{h\to0}\frac{f(x+h)-f(x)}{h} = 0.
    \]
\end{example}

\begin{example}
    La derivada de la función identidad $f(x)=x$ es también fácil de encontrar.  En efecto, para \xiR,
    \[
    \frac{f(x+h)-f(x)}{h} = \frac{x+h-x}h = \frac hh = 1,\ \ \forall h\neq 0
    \quad\implies\quad
    \lim_{h\to0}\frac{f(x+h)-f(x)}{h} = 1.
    \]
    Luego, para la función identidad $f(x)=x$, resulta $f'(x)=1$.
\end{example}

\begin{example}
    Ya vimos que la derivada de $f(x)=x^2$ es $f'(x)=2x$, y que la derivada de $g(x)=x^3$ es $g'(x)=3x^2$.
\end{example}

\begin{example}
    Consideremos ahora un ejemplo un poquito más complicado, que es el de la función \emph{seno}.
    Utilizaremos ahora la identidad trigonométrica que dice que
    \[
    \sen(a)-\sen(b) = 2 \cos\big(\frac{a+b}2\big) \sen\big(\frac{a-b}2\big), 
    \quad\text{para todo $a,b\in\R$}.
    \]
    Sea $f(x)=\sen(x)$. Planteamos el cociente incremental 
    \begin{align*}
        \lim_{h\to0} \frac{f(x+h)-f(x)}{h} 
        &= 
        \lim_{h\to0} \frac{\sen(x+h)-\sen(x)}{h} 
        = 
        \lim_{h\to0} \frac{2\cos\big(\frac{x+h+x}2\big)\sen\big(\frac{x+h-x}2\big)}{h} 
        \\
        &= 
        \lim_{h\to0} \cos\big(\frac{2x+h}2\big)\frac{2\sen\big(\frac{h}2\big)}{h} 
        = 
        \lim_{h\to0} \cos\big(x+\frac{h}2\big)\frac{\sen\big(\frac{h}2\big)}{h/2} 
        \\
        &= 
        \lim_{h\to0} \cos\big(x+\frac{h}2\big) \lim_{h\to0}  \frac{\sen\big(\frac{h}2\big)}{h/2} 
        = \cos(x) \cdot 1 = \cos (x),
    \end{align*}
    donde hemos utilizado que la función coseno es continua (que implica $\lim_{h\to 0}\cos(x+\frac h2)=\cos(x)$), y que $\lim_{y\to0}\sen(y)/y=1$.
    Por lo tanto, la derivada de la función $f(x)=\sen(x)$ es $f'(x)=\cos(x)$.
\end{example}

\begin{example}
    Veamos ahora cuál es la derivada de la función \emph{coseno}.
    Utilizaremos ahora la identidad trigonométrica que dice que
    \[
    \cos(a)-\cos(b) = -2 \sen\big(\frac{a+b}2\big) \sen\big(\frac{a-b}2\big), 
    \quad\text{para todo $a,b\in\R$}.
    \]
    Sea $f(x)=\cos(x)$. Planteamos el cociente incremental:
    \begin{align*}
        \lim_{h\to0} \frac{f(x+h)-f(x)}{h} 
        &= 
        \lim_{h\to0} \frac{\cos(x+h)-\cos(x)}{h} 
        =
        \lim_{h\to0} \frac{-2 \sen\big(\frac{x+h+x}2\big) \sen\big(\frac{x+h-x}2\big)}h
        \\
        &= 
        \lim_{h\to0} -\sen\big(x+\frac h2\big) \frac{\sen\big(\frac h2\big)}{h/2}
        = 
        -\lim_{h\to0} \sen\big(x+\frac h2\big) \lim_{h\to0} \frac{\sen\big(\frac h2\big)}{h/2}
        \\
        &= -\sen(x) \cdot 1 = -\sen(x),
    \end{align*}
    donde hemos utilizado que la función seno es continua (que implica $\lim_{h\to 0}\sen(x+\frac h2)=\sen(x)$), y nuevamente que $\D\lim_{y\to0}\sen(y)/y=1$.
    Por lo tanto, la derivada de la función $f(x)=\cos(x)$ es $f'(x)=\sen(x)$.
\end{example}

\begin{example}
    Consideremos ahora la función logaritmo natural $f(x)=\ln x$, con dominio $(0,+\infty)$. Planteamos el cociente incremental:
    \begin{align*}
        \frac{f(x+h)-f(x)}{h} 
        &= 
        \frac{\ln(x+h)-\ln(x)}h
        =
        \frac{\ln\big(\frac{x+h}x\big)}h
        =
        \frac1h \ln\big(\frac{x+h}x\big)
        \\
        &= 
        \ln \big(\frac{x+h}x\big)^{1/h}
        = \ln \big(1+\frac{h}{x}\big)^{1/h}
        = \ln \big(1+\frac{1}{x/h}\big)^{1/h}
        \\
        &= \ln\bigg( \big(1+\frac{1}{x/h}\big)^{x/h} \bigg)^{1/x}
        = \frac1x \ln \big(1+\frac{1}{x/h}\big)^{x/h}.
    \end{align*}        
    Ahora bien,
    \[
    \lim_{h\to 0} \big(1+\frac{1}{x/h}\big)^{x/h} 
    = \lim_{y\to\infty} \big(1+\frac{1}{y}\big)^{y}
    = e.
    \]
    Por lo tanto, $\lim_{h\to 0} \ln \big(1+\frac{1}{x/h}\big)^{x/h} =\ln e = 1$ y finalmente
    \[
    \lim_{h\to0}  \frac{\ln(x+h)-\ln(x)}h
        = \frac1x \cdot 1 = \frac1x.
    \]
    Es decir, la derivada de la función logaritmo natural $f(x)=\ln x$ es $\D f'(x)=\frac1x$.
\end{example}

\begin{example}
    Por último, estudiemos la derivada de la función exponencial $f(x)=e^x$.
     Planteamos el cociente incremental:
    \begin{align*}
        \frac{f(x+h)-f(x)}{h} 
        &= \frac{e^{x+h}-e^x}h
        = \frac{e^x \, e^h-e^x}h
        = \frac{e^x \big(e^h-1\big)}h
        = e^x \frac{e^h-1}h.
    \end{align*}
    Tenemos entonces que calcular $\limho \frac{e^h-1}h$. Hacemos el cambio de variable $y=e^h-1$ y observamos, por un lado, que $$\limho\, y = \limho (e^h-1) = e^0-1=1-1=0.$$
    Por otro lado, si $y=e^h-1$, entonces $e^h=1+y$ y $h=\ln(1+y)$. Luego,
    \begin{align*}
        \limho \frac{e^h-1}h 
        = \lim_{y\to0} \frac{y}{\ln(1+y)}
        = \lim_{y\to0} \frac{1}{\frac1y\ln(1+y)}
        = \lim_{y\to0} \frac{1}{\ln(1+y)^{1/y}}.
    \end{align*}
    Como vimos recién, $\lim_{y\to 0} (1+y)^{1/y}=e$, por lo que 
    $\lim_{y\to 0} \ln (1+y)^{1/y}=\ln e=1$, y finalmente
    \[
    \limho  \frac{e^{x+h}-e^x}h
    = e^x \limho \frac{e^h-1}h 
    = e^x \lim_{y\to0} \frac{1}{\ln(1+y)^{1/y}}
    = e^x \cdot 1 = 1.
    \]
    Es decir, la derivada de la función exponencial $f(x)=e^x$ es $f'(x)=e^x$.
\end{example}

Podemos resumir los resultados anteriores de la siguiente manera:

\noindent\hfil
\begin{minipage}{.4\textwidth}
\def\arraystretch{1.8}
\begin{tabular}{|c|c|}
    \hline
    $f(x)$ & $f'(x)$ \\
    \hline\hline
    $\D c$ (constante) 
    & $\D 0$
    \\ \hline
    $\D x^n$ 
    & $\D nx^{n-1}$
    \\ \hline
    $\D \sen x$ 
    & $\D \cos x$
    \\ \hline
    $\D \cos x$ 
    & $\D -\sen x$
    \\ \hline
    $\D \ln x$ 
    & $\D \frac1x$
    \\ \hline
    $\D e^x$ 
    & $\D e^x$
    \\ \hline
\end{tabular}
\end{minipage}
\hfil
\begin{minipage}{.4\textwidth}
\begin{align*}
    \frac{dc}{dx} &= 0 \\[5pt]
    \frac{d(x^n)}{dx} &= n x^{n-1}\\[5pt]
    \frac{d\sen x }{dx } &= \cos x  \\[5pt]
    \frac{d \cos x}{dx } &= -\sen x  \\[5pt]
    \frac{d\ln x }{dx } &=  \frac1x \\[5pt]
    \frac{d e^x}{dx } &= e^x
\end{align*}
\end{minipage}

Es importante notar que el procedimiento que nos llevó a las fórmulas de la tabla precedente, por un lado demuestra que todas las funciones consideradas son derivables en todo punto de su dominio, y por otro lado nos dice explícitamente cuánto valen sus derivadas en cualquier punto.

\subsubsection*{Ejercicios de la sección~\getcurrentref{chapter}.\getcurrentref{section}}

\begin{enumerate}
\input{ejercicios-ch-5-s-3}
\end{enumerate}


\section{Regla de la cadena}

La regla de la cadena es la regla que nos permite derivar la composición de funciones.

\begin{proposition}[Regla de la cadena]
Supongamos que $g$ es derivable en $x_0$ y que $f$ es derivable en $y_0 = g(x_0)$.
Entonces $f\circ g$ es derivable en $x_0$ y
\[
(f\circ g)'(x_0) = f'(y_0) \cdot g(x_0).
\]
\end{proposition}

\begin{proof}
Como $f$ es derivable en $y_0 = g(x_0)$, tenemos que
\[
f(y_0+k) = f(y_0) + f'(y_0) \cdot k + o(k).
\]
Como $g$ es derivable en $x_0$, tenemos que 
\[
g(x_0+h) = g(x_0) + g'(x_0) \cdot h + o(h).
\]
Luego
\begin{align*}
    f\circ g(x_0+h) 
    &= f\big(g(x_0+h)\big) \\
    &= f\big(g(x_0)+\underbrace{g'(x_0)[h]+o(h)}_k \big) \\
    &= f\big(y_0 +\underbrace{g'(x_0)[h]+o(h)}_k \big) \\
    &= f(y_0) + f'(y_0) \big[\underbrace{g'(x_0)h+o(h)}_k\big] + o(\underbrace{g'(x_0)h+o(h)}_k)
    \\
    &= f(y_0) + f'(y_0) \big[g'(x_0)h\big] +
        \underbrace{f'(y_0)\big[o(h)\big] + o(g'(x_0)h+o(h))}_{o(h)}.
\end{align*}
Luego
\begin{align*}
    f\circ g(x_0+h) &= f\circ g(x_0) + f'(y_0) \big[g'(x_0)h\big] + o(h)\\
     &= f\circ g(x_0) + f'(y_0) g'(x_0) \big[h\big] + o(h).
\end{align*}
Por lo tanto
\[
f\circ g'(x_0) = f'(y_0)\, g'(x_0) = f'\big(g(x_0)\big) \, g'(x_0).
\qedhere
\]
\end{proof}

\begin{comment}
Demostración con la definición alternativa.
\begin{align*}
    f\big(g(x+{\delta x})\big) &= f\big(g(x)+\underbrace{g'(x)[{\delta x}]+o({\delta x})}_{\delta g} \big) \\
    &= f\big(g(x)\big) + f'\big(g(x)\big) \big[\underbrace{g'(x){\delta x}+o({\delta x})}_{\delta g}\big] + o(\underbrace{g'(x){\delta x}+o({\delta x})}_{\delta g})
    \\
    &= f\big(g(x)\big) + f'\big(g(x)\big) \big[g'(x){\delta x}\big] +
    \underbrace{f'\big(g(x)\big)\big[o({\delta x})\big] + o(g'(x){\delta x}+o({\delta x}))}_{o({\delta x})}.
\end{align*}
Luego
\begin{align*}
    f\circ g(x+{\delta x}) &= f\circ g(x) + f'\big(g(x)\big) \big[g'(x){\delta x}\big] + o({\delta x})\\
    &= f\circ g(x) + f'\big(g(x)\big) g'(x) \big[{\delta x}\big] + o({\delta x}).
\end{align*}
Por lo tanto
\[
f\circ g'(x) = f'\big(g(x)\big) g'(x)
\]
\end{comment}

\begin{example}
    Calculemos la derivada de $h(x) = \sen(x^2+x)$. Definimos $y=g(x)=x^2+x$ y $f(y) = \sen(y)$.
    Luego $f'(y)=\cos(y)$ y $g'(x)=2x+1$. Entonces
    \[
    h'(x) = f\circ g'(x) = f'(y) g'(x) = \cos(y)\, (2x+1) = \cos(x^2+x)\, (2x+1).
    \]
    En palabras podemos describir lo que hemos hecho de la siguiente forma:
    como la función es el seno de una expresión, la derivada es el coseno de la expresión, pero multiplicado por la derivada de esa expresión.
\end{example}

\begin{remark}[Regla de la cadena con Notación de Leibniz]
    Notemos que si llamamos $y=g(x)$ y $z=f(y)$, entonces la regla de la cadena $ (f\circ g)'(x_0) = f'(y_0) \cdot g(x_0)$ se escribe
    \[
    \frac{dz}{dx} = \frac{dz}{dy}\cdot \frac{dy}{dx}.
    \]
\end{remark}

\begin{example}
    Consideremos $f:\R\to\R$ dada por $\D f(x)=\ln(1+e^x)$. Calculemos su derivada. Como la derivada de $\ln y = \frac1y$, la derivada de $\ln (1+e^x)$ es $\D \frac1{1+e^x}$ \emph{multiplicada por la derivada de $1+e^x$.} Es decir,
    \[
    f'(x) = \frac1{1+e^x}\cdot (0+e^x) = \frac{e^x}{1+e^x}.
    \]
    Si utilizamos la notación de Leibniz, tenemos:
    \[
    \frac{d \big(\ln (\overbrace{1+e^x)}^y\big)}{dx} 
    = \underbrace{\frac{1}{1+e^x}}_{\frac{d \ln y}{dy}= \frac1y} \cdot \frac{d(1+e^x)}{dx}
    = \frac1{1+e^x}\cdot (0+e^x) = \frac{e^x}{1+e^x}.
    \]
\end{example}

\paragraph{Composición de tres o más funciones.}
Si tenemos la composición de tres o más funciones, aplicamos reiteradamente la regla de la cadena, por ejemplo:
\begin{align*}
 (f\circ g\circ h)'(x_0)
 &= \big[f\circ (g\circ h)\big]'(x_0) 
 = f'(g\circ h(x_0)) \cdot (g\circ h)'(x_0)
 \\
 &= f'(g\circ h(x_0)) \cdot g'(h(x_0)) \cdot h'(x_0).
\end{align*}
Si les asignamos nombres a las variables intermedias, por ejemplo:
\[
u = h(x),\qquad v=g(u),\qquad w=f(v),
\]
entonces $w=(f\circ g\circ h)'(x)$, y 
\[
\frac{dw}{dx} = \frac{dw}{dv} \cdot \frac{dv}{du} \cdot \frac{du}{dx}.
\]

\begin{example}
    Consideremos ahora la función \emph{exponencial} $a^x$ definida para $a>0$ con dominio $\R$. Para calcular la derivada de esta función haremos uso de la identidad $a^x=e^{x \ln a}$ de la siguiente manera:
    \[
    \frac{d \big(a^x\big)}{dx} = \frac{d \big(e^{x \ln a}\big)}{dx}
    = \underbrace{e^{x \ln a}}_{a^x} \cdot \underbrace{\frac{d (x\ln a)}{dx}}_{\ln a \cdot 1}
    = a^x \cdot \ln a
    = \ln a \cdot a^x.
    \]
\end{example}

\begin{example}
    Consideremos ahora la función \emph{potencia} $x^\alpha$ para $\alpha\in\R$, con dominio $(0,+\infty)$. Utilizamos ahora la identidad $x^\alpha=e^{\alpha \ln x}$ de la siguiente manera
    \[
    \frac{d \big(x^\alpha\big)}{dx} = \frac{d \big(e^{\alpha \ln x}\big)}{dx}
    = \underbrace{e^{\alpha \ln x}}_{x^\alpha} \cdot \underbrace{\frac{d (\alpha \ln x)}{dx}}_{\alpha \cdot \frac1x}
    = x^\alpha \cdot \alpha \frac 1x
    = \alpha \, x^{\alpha-1}.
    \]
    Como caso particular, si $\alpha=n\in\N$ volvemos a obtener la fórmula $\D \frac{d \big(x^n\big)}{dx}=n \, x^{n-1}$. Pero ahora la fórmula vale para cualquier potencia, no necesariamente entero, por ejemplo
    \[
    \frac{d \sqrt{x}}{dx} 
    =
    \frac{d \big(x^{1/2}\big)}{dx}
    = \frac12 x^{\frac12-1} 
    = \frac12 x^{-\frac12}
    = \frac12\frac1{\sqrt{x}}
    = \frac1{2\sqrt{x}}.
    \]
\end{example}


\subsubsection*{Ejercicios de la sección~\getcurrentref{chapter}.\getcurrentref{section}}

\begin{enumerate}
\input{ejercicios-ch-5-s-4}
\end{enumerate}



\section{Teoremas del valor medio y aplicaciones}

En esta sección vamos a ver cómo el conocimiento de la derivada de una función nos puededar información acerca de la función misma. 
Eso no es extraño ya que, según indicamos en la primera sección de este capítulo, la derivada es una medida de la \emph{variación instantánea} de la función. Si uno conoce cómo varía la función, puede deducir propiedades de la función misma.

En primer lugar, recordemos que un punto $x_0$ se llama
\emph{punto máximo} de $f$ si $f(x_0)\ge f(x)$ para todo $x$ en el dominio de $f$.
En otras palabras, un punto máximo de $f$ es un punto en donde $f$ alcanza su máximo. Análogamente, un punto mínimo de $f$ es un punto en donde $f$ alcanza su menor valor posible.

Por ejemplo, si consideramos la función $f(x)=\cos(x)$, entonces el máximo de $f$ es $1$, y tiene infinitos puntos máximos, son todos los $x$ para los cuales $\cos(x)=1$, es decir, $x = 2n\pi$, $n\in\Z$.
Los puntos mínimos de $f$ son aquellos puntos donde $\cos(x)=-1$, es decir $x=\pi+2n\pi$, $n\in\Z$.
Recordemos que $f'(x)=-\sen(x)$, y observemos que $f'(x)=-\sen(x)=0$, para todos los puntos máximos y mínimos de $f$, que son todos los puntos de la forma $n\pi$, $n\in\Z$.

\centerline{\includegraphics[width=.8\textwidth]{pics/seno-coseno.png}}


Esto que observamos para la función coseno y su derivada, ocurre en general, como lo establece el siguiente teorema.

\begin{theorem}[Teorema de Fermat]
    Si $f$ está definida en el intervalo abierto $(a,b)$ y si $x_0\in(a,b)$ es un punto máximo o un punto mínimo de $f$ donde $f$ es derivable, entonces
    \[
    f'(x_0)=0.
    \]
\end{theorem}

\begin{proof}
    Supongamos que $f$ tiene un mínimo en $x_0$. Entonces
    \[
    f(x)\ge f(x_0), \quad\text{para todo $x\in (a,b)$.}
    \]
    Como $f$ es derivable, existe $\D\limxo \frac{f(x)-f(x_0)}{x-x_0} = f'(x_0)$, y luego
    \[
    f'(x_0) = \limxo \frac{f(x)-f(x_0)}{x-x_0} = \limxop \frac{f(x)-f(x_0)}{x-x_0} = \limxom \frac{f(x)-f(x_0)}{x-x_0}.
    \]
    Si $x>x_0$, entonces $\frac{f(x)-f(x_0)}{x-x_0}\ge 0$ por lo que 
    \[
    f'(x_0) = \limxop \frac{f(x)-f(x_0)}{x-x_0} \ge 0.
    \]
    Si $x<x_0$, entonces $\frac{f(x)-f(x_0)}{x-x_0}\le 0$ por lo que 
    \[
    f'(x_0) = \limxom \frac{f(x)-f(x_0)}{x-x_0} \le 0.
    \]
    Por lo tanto, $0 \le f'(x_0) \le 0$, es decir $f'(x_0)=0$.

    Análogamente se prueba la misma conclusión si $f$ tiene un máximo en $x_0$.
\end{proof}

Observemos que el teorema de Fermat no se puede aplicar si la función está definida sólo sobre un intervalo cerrado $[a,b]$ y alcanza su máximo o mínimo en un extremo.

\medskip
\centerline{\includegraphics[width=.8\textwidth]{pics/rolle.png}}

Ahora, para funciones definidas en intervalos cerrados, probamos el hecho, geométricamente evidente de que si una función toma el mismo valor en los extremos de un intervalo, entonces, en algún punto intermedio de dicho intervalo, la tangente será horizontal. Más precisamente:

\begin{theorem}[Teorema de Rolle]
    Si $f$ es continua en $[a,b]$, derivable en $(a,b)$ y $f(a)=f(b)$, entonces existe $c\in(a,b)$ tal que $f'(c)=0$.
\end{theorem}

\begin{proof}
    Como $f$ es continua en el intervalo cerrado $[a,b]$, entonces por el Teorema~\ref{T:continua->maximo y minimo} existe $x_1\in[a,b]$ donde $f$ alcanza su mínimo y existe $x_2\in [a,b]$ donde $f$ alcanza su máximo.

Existen diferentes posibilidades:
\begin{itemize}
    \item     Si $x_1\neq a$ y $x_1\neq b$, entonces $x_1\in(a,b)$. Luego, como $f$ es diferenciable en $(a,b)$ y alcanza su mínimo en $x_1\in(a,b)$, el Teorema de Fermat nos dice que $f'(x_1)=0$, y hemos probado el teorema.
    \item  Si $x_2\neq a$ y $x_2\neq b$, entonces $x_2\in(a,b)$. Luego, como $f$ es diferenciable en $(a,b)$ y alcanza su máximo en $x_2\in(a,b)$, el Teorema de Fermat nos dice que $f'(x_2)=0$, y hemos probado el teorema.
    \item Si no ocurre ningúno de los dos casos anteriores, quiere decir que los máximos y mínimos se alcanzan en los extremos del intervalo. Pero en los extremos del intervalo la función toma el mismo valor, luego
    \[
    f(a)=f(b)\le f(x)\le f(a)=f(b), \quad\text{para todo $x\in [a,b]$}.
    \]
    Es decir, la función $f$ es constante en $[a,b]$ y por lo tanto $f'(x)=0$ para todo $x\in(a,b)$.\qedhere
\end{itemize}
\end{proof}

Este fue nuestro primer Teorema del Valor Medio. El segundo, que enunciaremos y probaremos a continuación, tiene también una interpretación geométrica: existe algún punto entre $a$ y $b$ en donde la recta tangente es paralela a la \emph{cuerda} (recta que pasa por $(a,f(a))$ y $(b,f(b))$.

\medskip
\centerline{\includegraphics[width=.6\textwidth]{pics/tvm.png}}

\begin{theorem}[Teorema del Valor Medio (de Lagrange)]\label{T:TVM}
       Si $f$ es continua en $[a,b]$ y derivable en $(a,b)$, entonces existe $c\in(a,b)$ tal que 
       \[
       f'(c)=\frac{f(b)-f(a)}{b-a}.
       \]
\end{theorem}

\begin{proof}
    Para demostrar este teorema, consideramos la ecuación de la recta  que pasa por $(a,f(a))$ y $(b,f(b))$:
    \[
    y - f(a) = \frac{f(b)-f(a)}{b-a} (x-a),
    \]
    que puede escribirse también como
    \[    
    y = f(a) + \frac{f(b)-f(a)}{b-a} (x-a).
    \]
    Ahora definimos la función 
    \[
    g(x) = f(x) - \left[ f(a) + \frac{f(b)-f(a)}{b-a} (x-a) \right].
    \]
    Esta función cumple que es continua en $[a,b]$ y derivable en $(a,b)$. Además:
    \begin{align*}
        g(a) &= f(a) - \left[ f(a) + \frac{f(b)-f(a)}{b-a} \underbrace{(a-a)}_0 \right] 
        = f(a)-f(a)=0,
        \\
        g(b) &= f(b) - \left[ f(a) + \frac{f(b)-f(a)}{\cancel{b-a}} \cancel{(b-a)} \right] 
        = f(b)-\left[f(a)+f(b)-f(a)\right] = 0.
    \end{align*}
    Por lo tanto, $g(a)=g(b)=0$ y $g$ cumple las hipótesis del Teorema de Rolle, y luego existe $c\in(a,b)$ tal que $g'(c)=0$. 
    Si calculamos la derivada de $g$, vemos que
    \[
    g'(x) = f'(x) - \frac{f(b)-f(a)}{b-a} \cdot 1,
    \]
    y luego 
    \[
    0 = g'(c) = f'(c) - \frac{f(b)-f(a)}{b-a} ,
    \]
    que inmediatamente implica lo que queríamos demostrar.
\end{proof}

Pasamos ahora a probar consecuencias del Teorema del Valor Medio.

En primer lugar, recordemos que la derivada de una función constante es la función nula.
Nos planteamos la pregunta recíproca. Si una función tiene derivada nula en todo punto: ?`Es esa función necesariamente constante?
La respuesta es efectivamente afirmativa:

\begin{proposition}
    Si $f$ es continua en $[a,b]$, derivable en $(a,b)$ y $f'(x)=0$, para todo $x\in(a,b)$, entonces % existe $k\in\R$ tal que 
    \[ 
    f(x)=f(a), \quad\text{para todo $x\in [a,b]$}.
    \]
\end{proposition}

\begin{proof}
    Sea $x_0 \in (a,b]$. Luego $[a,x_0]\subset [a,b]$ y resulta que $f$ es continua en $[a,x_0]$ y derivable en $(a,x_0)$. Entonces cumple las hipótesis del Teorema del valor medio en el intervalo $[a,x_0]$, por lo tanto, existe $c\in [a,x_0]$ tal que 
    \[
    f'(c) = \frac{f(x_0)-f(a)}{x_0-a}.
    \]
    Pero $f'(c)=0$ por lo que $f(x_0)-f(a)=0$ que a su vez implica $f(x_0)=f(a)$. Con esto concluye nuestra demostración.
\end{proof}

\begin{corollary}
    Si $f$ y $g$ son continuas en $[a,b]$, derivables en $(a,b)$ y $f'(x)=g'(x)$, para todo $x\in(a,b)$, entonces existe $k\in\R$ tal que 
    \[ 
    f(x)=g(x)+k, \quad\text{para todo $x\in [a,b]$}.
    \]
\end{corollary}

\begin{proof}
    Definimos $h(x)=f(x)-g(x)$. Luego 
    \[
    h'(x)=f'(x)-g'(x)=0, \quad\text{para todo $x\in [a,b]$}.
    \]
    Entonces $f(x)-g(x)=f(a)-g(a)$, para todo $x\in[a,b]$. 
    Llamando $k=f(a)-g(a)$ se obtiene el resultado deseado.
\end{proof}

El siguiente resultado es una consecuencia importante del Teorema del Valor Medio, que nos permite deducir información de $f$ a partir de información sobre su derivada $f'$.

\begin{proposition}
    Sea $f$ una función continua en $[a,b]$ y derivable en $(a,b)$:
    \begin{enumerate}
        \item Si $f'(x)>0$ para todo $x\in(a,b)$, entonces $f$ es estrictamente creciente en $[a,b]$, 
        es decir, si $a\le x_1<x_2\le b$, entonces $f(x_1)<f(x_2)$.
        \item Si $f'(x)<0$ para todo $x\in(a,b)$, entonces $f$ es estrictamente decreciente en $[a,b]$,
        es decir, si $a\le x_1<x_2\le b$, entonces $f(x_1)>f(x_2)$.
    \end{enumerate}
\end{proposition}

\begin{proof}
    \begin{enumerate}
        \item Sean $x_1,x_2\in[a,b]$ con $x_1<x_2$, es decir, $a\le x_1<x_2\le b$. Consideramos $f$ sobre el intervalo $[x_1,x_2]$ resulta que $f$ es continua en ese intervalo y derivable en $(x_1,x_2)$. Es decir, satisface las hipótesis del Teorema del Valor Medio (Teorema~\ref{T:TVM}) en el intervalo $[x_1,x_2]$.
        Por lo tanto, existe $c\in(x_1,x_2)$ tal que 
        \[
        \frac{f(x_2)-f(x_1)}{x_2-x_1} = f'(c).
        \]
        O sea,
        \[
        f(x_2)-f(x_1) = f'(c)\, (x_2-x_1).
        \]
        Pero $f'(c)>0$, por lo que $f(x_2)-f(x_1)>0$, o lo que es lo mismo, $f(x_2)>f(x_1)$.
        
        \item Se prueba de la misma manera, sólo que ahora $f'(c)<0$ y por lo tanto $f(x_2)-f(x_1)<0$, que es lo mismo que decir $f(x_2)<f(x_1)$.
    \end{enumerate}
\end{proof}

Presentamos ahora un teorema importante que nos va a servir para calcular las derivadas de más funciones.

\begin{theorem}[Derivada de la función inversa]
    Sea $f$ una función continua y estrictamente creciente, o estrictamente decreciente en $[a,b]$ (con lo cual existe inversa):
    \begin{itemize}
        \item $\D f^{-1}:[f(a),f(b)]\to [a,b]$ cuando $f$ es estrictamente creciente;
        \item $\D f^{-1}:[f(b),f(a)]\to [a,b]$ cuando $f$ es estrictamente decreciente.
    \end{itemize}
    Si $x\in(a,b)$ es un punto tal que $f$ es derivable en $x$, y $f'(x)\neq 0$, entonces $f^{-1}$ es derivable en $y=f(x)$ y además:
    \[
    \big(f^{-1}\big)'(y) = \frac1{f'(x)},
    \]
    que también podemos escribir así:
    \begin{equation}\label{eq:derivada inversa}
    \big(f^{-1}\big)'(f(x)) = \frac1{f'(x)},
    \qquad\text{o}\qquad
    \big(f^{-1}\big)'(y) = \frac1{f'(f^{-1}(y))},
    \end{equation}
\end{theorem}

\begin{proof}
    La demostración se verá en la clase de \emph{Coloquio de demostraciones}.
\end{proof}

\begin{example}
    Consideremos la función $f:\R\to\R$ dada por $f(x)=\sen x$. 
    Su derivada es $f'(x)=\cos x$, que es positiva en el intervalo $-\frac\pi2<x<\frac\pi2$.
    Luego, el seno es una función estrictamente creciente en $[-\pi/2,\pi/2]$ y como además es continua, existe función inversa 
    \[
    \arcsen: [-1,1] \to \Big[-\frac\pi2,\frac\pi2\Big]:
    \qquad
    \arcsen y = x \quad\iff\quad \sen x = y.
    \]

    \centerline{\includegraphics[width=.8\textwidth]{pics/seno-arcseno.jpeg}}
    
    Como $\sen'(x)=\cos(x)\neq 0$ en $\big(-\frac\pi2,\frac\pi2\big)$, entonces $\arcsen$ es derivable en $(-1,1)$.
    Para hallar su derivada, usamos la segunda fórmula de~\eqref{eq:derivada inversa}:
    \[
    \arcsen'(y) = \frac{1}{\sen'(\arcsen y)}
    = \frac1{\cos(\arcsen y)} = \frac1{\cos x},
    \]
    donde $x=\arcsen y$. Entonces $\sen x=y$, y tenemos que deducir cuánto vale $\cos x$ sabiendo que $\sen x = y$. Para esto, utilizaremos que
    \[
    \cos^2 x + \sen^2 x = 1,\qquad\text{y}\qquad x\in\big(-\frac\pi2,\frac\pi2\big).
    \]
    De la primera deducimos que $\cos x = \pm \sqrt{1-y^2}$, como $x\in\big(-\frac\pi2,\frac\pi2\big)$ deducimos que $\cos x > 0$ por lo que $\cos x = \sqrt{1-y^2}$. Luego
    \[
    \arcsen'(y) = \frac1{\sqrt{1-y^2}}, \qquad \text{para $y\in (-1,1)$}.
    \]
\end{example}

\begin{example}
    Consideremos ahora la función $f:\R\to\R$ dada por $f(x)=\cos x$. 
    Su derivada es $f'(x)=-\sen x$, que es negativa en el intervalo $0<x<\pi$.
    Luego, el coseno es una función estrictamente decreciente en $[0,\pi]$ y como además es continua, existe función inversa 
    \[
    \arccos: [-1,1] \to [0,\pi]:
    \qquad
    \arccos y = x \quad\iff\quad \cos x = y.
    \]

    \centerline{\includegraphics[width=.8\textwidth]{pics/cos-arccos.jpeg}}
    
    Como $\cos'(x)=-\sen(x)\neq 0$ en $(0,\pi)$, entonces $\arccos$ es derivable en $(-1,1)$.
    Para hallar su derivada, usamos la segunda fórmula de~\eqref{eq:derivada inversa}:
    \[
    \arccos'(y) = \frac{1}{\cos'(\arccos y)}
    = -\frac1{\sen(\arccos y)} = -\frac1{\sen x},
    \]
    donde $x=\arccos y$. Entonces $\cos x=y$, y tenemos que deducir cuánto vale $\sen x$ sabiendo que $\cos x = y$. Para esto, utilizaremos que
    \[
    \cos^2 x + \sen^2 x = 1,\qquad\text{y}\qquad x\in(0,\pi).
    \]
    De la primera deducimos que $\sen x = \pm \sqrt{1-y^2}$, como $x\in(0,\pi)$ deducimos que $\sen x > 0$ por lo que $\sen x =  \sqrt{1-y^2}$. Luego
    \[
    \arccos'(y) = -\frac1{\sqrt{1-y^2}}, \qquad \text{para $y\in (-1,1)$}.
    \]
\end{example}

Veamos un último ejemplo:

\begin{example}
    Consideremos ahora la función dada por $\D f(x)=\tan x=\frac{\sen x}{\cos x}$, cuyo dominio es todo $\R$ excepto los puntos de la forma $\frac\pi2+n\pi$, $n\in\Z$, que son los puntos donde se anula el denominador $\cos x$.
    Quedó como ejercicio en una de las secciones anteriores calcular $\tan'(x)$, y la respuesta era
    \[
    \tan'(x)=\frac1{\cos^2x}.
    \]
    Esta derivada es siempre positiva, por lo tanto, $f(x)$ es estrictamente creciente en cada intervalo de la forma $(n\pi-\frac\pi2,n\pi+\frac\pi2)$. Consideremos esta función en el intervalo $(-\frac\pi2,\frac\pi2)$, donde es estrictamente creciente. Observamos que
    \[
    \lim_{x\to-\frac\pi2^+}\tan(x)=-\infty,
    \qquad\text{y}\qquad
    \lim_{x\to\frac\pi2^-}\tan(x)=+\infty.
    \]
    Por lo tanto, la función tangente es biyectiva de $(-\frac\pi2,\frac\pi2)$ en $(-\infty,+\infty)$, y existe función inversa 
    \[
    \arctan: \R \to \Big(-\frac\pi2,\frac\pi2\Big)
    \qquad
    \arctan y = x \quad\iff\quad \tan x = y.
    \]

    \centerline{\includegraphics[width=.8\textwidth]{pics/tan-atan.jpeg}}
    
 Como $\tan'(x)=\frac1{\cos^2(x)}> 0$ en $(-\frac\pi2,\frac\pi2)$, entonces $\arctan$ es derivable en $\R$.
    Para hallar su derivada, usamos la segunda fórmula de~\eqref{eq:derivada inversa}:
    \[
    \arctan'(y) = \frac{1}{\tan'(\arctan y)}
    = \frac1{\frac1{\cos^2(\arctan y)}} 
    = \cos^2(\arctan y)
    = \cos^2 x,
    \]
    donde $x=\arctan y$. Entonces $\tan x=y$, y tenemos que deducir cuánto vale $\cos^2 x$ sabiendo que $\tan x = y$. 
    Veamos
    \begin{align*}
        \frac{\sen x}{\cos x} = y
        &\implies
        \frac{\sen^2 x}{\cos^2 x} = y^2
        \implies 
        \frac{1-\cos^2 x}{\cos^2 x} = y^2
        \\
        &\implies
        1-\cos^2 x = y^2 \, \cos^2x
        \implies 
        1 = \cos^2 x + y^2 \, \cos^2x
        = \cos^2 x \, \big(1+y^2\big)
        \\
        &\implies \cos^2x = \frac1{1+y^2}.
    \end{align*}
    De aquí obtenemos que
    \[
    \arctan'(y) =  \frac1{1+y^2},
    \quad\text{para todo $y\in\R$.}
    \]
\end{example}


\subsubsection*{Ejercicios de la sección~\getcurrentref{chapter}.\getcurrentref{section}}

\begin{enumerate}
\input{ejercicios-ch-5-s-5}
\end{enumerate}


\section{Regla de L'Hospital}


\subsubsection*{Ejercicios de la sección~\getcurrentref{chapter}.\getcurrentref{section}}

\begin{enumerate}
\item 
\end{enumerate}


\section{Estudio de funciones}


\subsubsection*{Ejercicios de la sección~\getcurrentref{chapter}.\getcurrentref{section}}

\begin{enumerate}
\item 
\end{enumerate}



\subsection*{Ejercicios del capítulo~\getcurrentref{chapter}}



